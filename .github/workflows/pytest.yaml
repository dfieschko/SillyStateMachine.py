name: pytest

on: [push, pull_request, workflow_dispatch] # run on pull requests and push events, allow manual use

jobs:
  test:
    runs-on: ${{ matrix.os }} # run on every OS specified in matrix
    strategy:
      fail-fast: false  # don't quit all jobs if a single job fails
      matrix:           # set up multiple environments to test on
        os: ["ubuntu-latest", "windows-latest", "macos-latest"]           # cover all our bases
        python-version: ["3.5.10", "3.6.15", "3.7.12", "3.8.12", "3.9.7"] # test python 3.5 & onward
        architecture: ["x64", "x86"]

    steps: # steps to take to test package
      - name: Checkout
        uses: actions/checkout@v2 # https://github.com/actions/checkout

      - name: Setup
        uses: actions/setup-python@v2 # https://github.com/actions/setup-python
        with:
          python-version: ${{ matrix.python-version }}  # test on all python versions specified
          architecture: ${{ matrix.architecture }}      # test on all architectures specified
      
      - name: Install
        run: |
          pip install --upgrade pytest
          pip install --upgrade pytest-cov

      - name: Test
        run: |
          py -m pytest -v --cov=SillyStateMachine
